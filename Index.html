<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Counter</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body class="light-mode">
<button class="theme-toggle" id="theme-toggle">☀️</button>

<div class="counter-container">
    <div class="counter" id="counter">0</div>
</div>

<input type="number" id="goal-input" value="100" />

<button class="minus-button" id="minus-button">-</button>
<button class="plus-button" id="plus-button">+</button>

<div class="goal" id="goal">
    <span id="goal-text">100</span>
    <button class="reset-button" id="reset-button">Reset</button>
</div>

<script>
    let count = 0;
    let goal = 100;
    const counterElement = document.getElementById('counter');
    const goalElement = document.getElementById('goal-text');
    const goalInput = document.getElementById('goal-input');
    const plusButton = document.getElementById('plus-button');
    const minusButton = document.getElementById('minus-button');
    const themeToggleButton = document.getElementById('theme-toggle');
    const resetButton = document.getElementById('reset-button');
    const body = document.body;

    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        body.classList.remove('light-mode', 'dark-mode');
        body.classList.add(savedTheme);
        themeToggleButton.textContent = savedTheme === 'dark-mode' ? '🌙' : '☀️';
    }

    const savedCounter = localStorage.getItem('counter');
    if (savedCounter !== null) {
        count = parseInt(savedCounter, 10);
        counterElement.textContent = count;
    }

    themeToggleButton.addEventListener('click', () => {
        if (body.classList.contains('light-mode')) {
            body.classList.remove('light-mode');
            body.classList.add('dark-mode');
            themeToggleButton.textContent = '🌙';
            localStorage.setItem('theme', 'dark-mode');
        } else {
            body.classList.remove('dark-mode');
            body.classList.add('light-mode');
            themeToggleButton.textContent = '☀️';
            localStorage.setItem('theme', 'light-mode');
        }
    });

    goalInput.addEventListener('input', () => {
        const newGoal = parseInt(goalInput.value, 10);
        if (!isNaN(newGoal) && newGoal > 0) {
            goal = newGoal;
            updateGoal();
        }
    });

    plusButton.addEventListener('click', (e) => {
        count++;
        updateCounter();
        e.stopPropagation();
    });

    minusButton.addEventListener('click', (e) => {
        count--;
        updateCounter();
        e.stopPropagation();
    });

    resetButton.addEventListener('click', () => {
        count = 0;
        goal = 100;
        goalInput.value = goal;
        updateCounter();
    });

    function updateCounter() {
        counterElement.textContent = count;
        localStorage.setItem('counter', count);
        updateGoal();
    }

    function updateGoal() {
        const remaining = goal - count;
        goalElement.textContent = `${remaining} left`;
    }

    document.body.addEventListener('click', (e) => {
        if (e.target !== goalInput && e.target !== plusButton && e.target !== minusButton && !e.target.closest('.goal')) {
            const rect = counterElement.getBoundingClientRect();
            if (e.clientX < rect.left) {
                count--;
            } else if (e.clientX > rect.right) {
                count++;
            }
            updateCounter();
            e.preventDefault();
        }
    });
</script>
</body>
</html>